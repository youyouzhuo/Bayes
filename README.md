# 邮件分类系统

## 项目概述
基于朴素贝叶斯算法的二分类系统，实现垃圾邮件与普通邮件的自动化识别。支持两种特征选择模式，包含数据平衡处理与多维度评估。

### 主要功能
- 高频词/TF-IDF双模式特征提取
- SMOTE过采样处理样本失衡
- 分类精度/召回率/F1值综合评估
- 未知邮件自动分类预测
### 算法基础
本系统采用多项式朴素贝叶斯分类器，基于特征条件独立性假设构建分类模型。算法假设邮件中各词语的出现概率相互独立，通过贝叶斯定理计算后验概率：给定邮件文本D，其属于垃圾邮件的概率为P(Spam∣D)∝P(Spam)∏ wi ∈D P(wi∣Spam)，其中P(wi∣Spam)表示垃圾邮件中词语w i​ 的条件概率，P(Spam)为垃圾邮件先验概率，最终通过比较P(Spam∣D)与P(Ham∣D)的比值实现分类决策。
### 数据处理流程
原始邮件数据经过多阶段预处理：首先通过正则表达式，随后采用jieba分词工具进行细粒度词语切分，最后执行两级停用词过滤——既删除长度≤1的无效词项（如标点残留），又通过预设列表移除常见虚词（"的"、"了"等）。处理后的词序列以空格连接，形成标准化文本输入。
### 特征构建过程
高频词特征选择与TF-IDF特征加权的核心差异在于特征构建的逻辑与数学建模方式：高频词方法通过统计文档集中词汇的总体频次，数学表达式为<img width="143" alt="2f1a5c98d140d985b6858c5d7dd9043" src="https://github.com/user-attachments/assets/cda7b780-120e-4ac2-83e2-3b7a6a5519df" />
直接选取频次最高的词作为特征，其实现简单高效但易受常见无意义词干扰；而TF-IDF则通过融合词频（TF）和逆文档频率（IDF）构建加权特征（公式为<img width="249" alt="1695a2fdd4a80b79129a29828b5bdc3" src="https://github.com/user-attachments/assets/81886725-69ec-4b6f-8f20-3bb0ac2ee7ac" />）
，在计算每个词在单文档中的局部重要性（TF）的同时，引入全局统计量（IDF）抑制高频常见词（如“的”“是”），从而突出跨文档区分度高的词汇（如专业术语），其实现需分步计算TF矩阵与IDF权重并进行乘积融合，虽计算复杂度较高，但能显著提升文本分类、检索等任务的特征表达能力。两者分别适用于实时性要求高的粗粒度主题筛选与需精准语义建模的复杂场景。在这段代码中，高频词特征选择与TF-IDF特征加权的核心差异体现在特征构建方式上：高频词方法通过拼接训练集文本、统计全局词频（如Counter(all_terms).most_common(top_num)），直接选取前N个高频词作为固定词表，并生成原始词频向量​（未归一化），可能包含大量常见无意义词；而TF-IDF方法通过TfidfVectorizer自动实现局部词频归一化（TF）​与全局逆文档频率加权（IDF）​，动态计算词汇在单文档中的相对重要性和跨文档的稀缺性（如log(N/(1+DF))），同时限制特征维度为top_num，既保留高频词又抑制常见词（如“的”“是”），最终生成加权特征向量，从而提升模型对垃圾邮件中领域特异性词汇（如“促销”“免费”）的敏感度，两者分别通过简单统计和数学建模实现了特征从“数量优先”到“质量优先”的优化。
### 特征模式切换方法
用户可通过修改代码参数feature_type在两种模式间灵活切换：在main()函数中设置feature_type='frequency'启用高频词特征，或设为'tfidf'激活TF-IDF加权。命令行运行支持--feature参数快速指定，如python classify.py --feature tfidf即启动TF-IDF模式，系统将自动适配对应的特征工程管道，无需修改核心处理逻辑。
### 样本平衡处理
针对原始数据中垃圾邮件（127条）与普通邮件（24条）的样本量失衡问题，系统采用SMOTE（Synthetic Minority Oversampling Technique）过采样技术实现数据平衡。该算法通过在少数类样本的特征空间内，基于k近邻（默认k=5）插值生成合成样本，使两类样本量达到1:1均衡。具体实现中，SMOTE仅应用于训练集以避免数据泄漏，通过调整sampling_strategy参数可控制过采样比例（如设置为0.8生成80%的少数类样本），有效提升模型对普通邮件的识别敏感度。
### 模型评估指标
系统在基础准确率之外，引入多维度评估指标体系：精确率（Precision）衡量预测为垃圾邮件中的真实占比，召回率（Recall）评估实际垃圾邮件的检出完整性，F1值（F1-score）作为两者的调和平均提供综合评判。评估报告特别输出宏平均（Macro Avg）和加权平均（Weighted Avg）两种聚合指标，前者平等对待各类别适用于严重不平衡场景，后者按样本量加权反映整体性能。针对151-155.txt的预测样本，系统额外提供混淆矩阵可视化选项，清晰展示TP/FP/FN/TN四类结果。
### 结果示例
![屏幕截图(57)](https://github.com/user-attachments/assets/6072582f-0ee3-47a4-8f82-5fd7f5092abe)
这是只有classify的代码
![屏幕截图(58)](https://github.com/user-attachments/assets/6691e35c-a2cc-47c6-a47a-8e7c9841eea0)
这是加了样本平衡处理的运用了SMOTE的classify的代码
![屏幕截图(59)](https://github.com/user-attachments/assets/43a88c08-0eeb-45f4-afe7-848c0a6e4e55)
这是加了样本平衡处理和模型评估指标的引入多维度评估指标体系的代码


